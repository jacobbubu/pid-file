// Generated by CoffeeScript 1.7.1
var PIDFILE, ctx, fs, os, path;

fs = require('fs');

os = require('os');

path = require('path');

ctx = {};

PIDFILE = {
  create: function(options) {
    var pid;
    ctx = options;
    ctx.path = PIDFILE.path(options.filename, options.local);
    pid = process.pid;
    if (ctx.errorOnExist === true) {
      if (fs.existsSync(ctx.path)) {
        throw new Error("Error : pif file (" + ctx.path + ") already exists.");
      }
    }
    fs.writeFileSync(ctx.path, pid);
    if (ctx.deleteOnExit === true) {
      return process.on('exit', function() {
        return PIDFILE["delete"]();
      });
    }
  },
  path: function(filename, local) {
    if (local) {
      return filename;
    }
    return path.join(os.tmpDir(), filename);
  },
  "delete": (function(_this) {
    return function() {
      return fs.unlinkSync(ctx.path);
    };
  })(this)
};

module.exports = PIDFILE;
